<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nexus Media - Ultimate WebApp</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="nexus-ultimate.css">
</head>
<body>
    <!-- Background Effects -->
    <canvas id="meshGradient"></canvas>
    <canvas id="particleCanvas"></canvas>
    <div id="spotlight"></div>
    <div class="noise-overlay"></div>

    <!-- Loader -->
    <div id="loader">
        <div class="loader-content">
            <div class="loader-orb">
                <div class="orb-ring"></div>
                <div class="orb-ring"></div>
                <div class="orb-ring"></div>
                <div class="orb-core"></div>
            </div>
            <div class="loader-text">NEXUS MEDIA</div>
            <div class="loader-progress"><div class="loader-progress-fill"></div></div>
        </div>
    </div>

    <!-- Main App -->
    <div id="app">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="user-avatar" id="userAvatar">N</div>
                <div class="user-info">
                    <div class="user-name" id="userName">Foydalanuvchi</div>
                    <div class="user-tier" id="userTier"><i class="fas fa-star"></i><span>Standard</span></div>
                </div>
            </div>
            <div class="header-right">
                <div class="header-stats">
                    <div class="connection-status" id="connectionStatus" title="Checking connection...">
                        <i class="fas fa-wifi"></i>
                    </div>
                    <div class="header-stat">
                        <i class="fas fa-bolt"></i>
                        <span id="headerXP">0</span>
                    </div>
                    <div class="header-stat gold">
                        <i class="fas fa-coins"></i>
                        <span id="headerGold">0</span>
                    </div>
                    <button class="settings-btn" id="settingsBtn"><i class="fas fa-cog"></i></button>
                </div>
            </div>
        </header>

        <!-- Stats Bar -->
        <div class="stats-bar">
            <div class="stat-chip"><i class="fas fa-layer-group"></i><span id="statLevel">1</span></div>
            <div class="stat-chip"><i class="fas fa-fire"></i><span id="statStreak">0</span></div>
            <div class="stat-chip"><i class="fas fa-users"></i><span id="statReferrals">0</span></div>
            <div class="stat-chip dark-matter" id="darkMatterChip" style="display:none"><i class="fas fa-atom"></i><span id="statDarkMatter">0</span></div>
        </div>

        <!-- Section: Gamification -->
        <section id="sectionGamification" class="section active">
            <!-- Mining Card -->
            <div class="mining-card">
                <div class="mining-header">
                    <div class="mining-balance">
                        <span class="balance-label">Balans</span>
                        <span class="balance-value" id="miningBalance">0</span>
                    </div>
                    <div class="mining-stats">
                        <div class="mining-stat"><i class="fas fa-hand-pointer"></i><span id="tapPower">1</span>/tap</div>
                        <div class="mining-stat"><i class="fas fa-robot"></i><span id="autoTapRate">0</span>/s</div>
                    </div>
                </div>

                <div class="claim-container" id="claimContainer" style="display:none; margin-bottom: 15px;">
                    <div class="claim-info">
                        <span>Auto-Mining:</span>
                        <span class="claim-amount" id="claimAmount">0</span>
                    </div>
                    <button class="claim-btn" id="claimBtn">Claim</button>
                </div>

                <div class="active-effects" id="activeEffectsContainer" style="display:none;"></div>
                
                <div class="reactor-container">
                    <div class="reactor-glow"></div>
                    <div class="reactor-rings">
                        <div class="reactor-ring r1"></div>
                        <div class="reactor-ring r2"></div>
                        <div class="reactor-ring r3"></div>
                    </div>
                    <div class="reactor-core" id="reactorCore">
                        <div class="core-inner"></div>
                        <div class="core-pulse"></div>
                    </div>
                </div>

                <div class="energy-bar">
                    <div class="energy-fill" id="energyFill"></div>
                    <span class="energy-text" id="energyText">1000/1000</span>
                </div>
            </div>

            <!-- Upgrades -->
            <div class="section-title"><i class="fas fa-arrow-up"></i>Yaxshilashlar</div>
            <div class="upgrades-grid" id="upgradesGrid"></div>

            <!-- Leaderboard Preview -->
            <div class="section-title"><i class="fas fa-trophy"></i>Reyting</div>
            <div class="leaderboard-preview">
                <div class="podium" id="podium"></div>
                <button class="view-all-btn" data-modal="leaderboard"><i class="fas fa-list"></i>Barchasini ko'rish</button>
            </div>

            <!-- Daily Challenges -->
            <div class="section-title"><i class="fas fa-tasks"></i>Kunlik vazifalar</div>
            <div class="challenges-list" id="challengesList"></div>

            <!-- Achievements Preview -->
            <div class="section-title"><i class="fas fa-medal"></i>Yutuqlar</div>
            <div class="achievements-preview" id="achievementsPreview"></div>
            <button class="view-all-btn" data-modal="achievements"><i class="fas fa-trophy"></i>Barcha yutuqlar</button>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="quick-action-btn" data-modal="shop"><i class="fas fa-store"></i>Do'kon</button>
                <button class="quick-action-btn" data-modal="referral"><i class="fas fa-share-nodes"></i>Referral</button>
                <button class="quick-action-btn" data-modal="notifications"><i class="fas fa-bell"></i>Xabarlar</button>
            </div>

            <!-- Prestige Section -->
            <div class="prestige-section" id="prestigeSection" style="display:none">
                <div class="prestige-info">
                    <i class="fas fa-atom"></i>
                    <div>
                        <h3>Prestige tayyor!</h3>
                        <p>+<span id="prestigeReward">0</span> Dark Matter olasiz</p>
                    </div>
                </div>
                <button class="prestige-btn" id="prestigeBtn"><i class="fas fa-rocket"></i>PRESTIGE</button>
            </div>
        </section>

        <!-- Section: New Functions -->
        <section id="sectionNewFunctions" class="section">
            <div class="section-header">
                <h2><i class="fas fa-sparkles"></i>Yangi funksiyalar</h2>
                <p>Eng so'nggi imkoniyatlar</p>
            </div>

            <div class="functions-grid">
                <div class="function-card" data-func="ai-test">
                    <div class="function-icon"><i class="fas fa-robot"></i></div>
                    <div class="function-info">
                        <h3>AI Test yaratish</h3>
                        <p>Sun'iy intellekt yordamida test yarating</p>
                    </div>
                    <div class="function-badge new">Yangi</div>
                </div>

                <div class="function-card" data-func="rpg">
                    <div class="function-icon"><i class="fas fa-gamepad"></i></div>
                    <div class="function-info">
                        <h3>RPG tizimi</h3>
                        <p>O'yin orqali o'rganing</p>
                    </div>
                    <div class="function-badge hot">Hot</div>
                </div>

                <div class="function-card" data-func="duel">
                    <div class="function-icon"><i class="fas fa-swords"></i></div>
                    <div class="function-info">
                        <h3>Duel rejimi</h3>
                        <p>Do'stlaringiz bilan bellashing</p>
                    </div>
                </div>

                <div class="function-card" data-func="srs">
                    <div class="function-icon"><i class="fas fa-brain"></i></div>
                    <div class="function-info">
                        <h3>SRS takrorlash</h3>
                        <p>Intervalli takrorlash tizimi</p>
                    </div>
                </div>

                <div class="function-card" data-func="adaptive">
                    <div class="function-icon"><i class="fas fa-chart-line"></i></div>
                    <div class="function-info">
                        <h3>Adaptiv test</h3>
                        <p>Darajangizga moslashgan testlar</p>
                    </div>
                </div>

                <div class="function-card" data-func="my-tests">
                    <div class="function-icon"><i class="fas fa-folder"></i></div>
                    <div class="function-info">
                        <h3>Mening testlarim</h3>
                        <p>Saqlangan testlaringiz</p>
                    </div>
                </div>

                <div class="function-card" data-func="mistakes">
                    <div class="function-icon"><i class="fas fa-times-circle"></i></div>
                    <div class="function-info">
                        <h3>Xatolarim</h3>
                        <p>Xatolarni tahlil qiling</p>
                    </div>
                </div>

                <div class="function-card" data-func="statistics">
                    <div class="function-icon"><i class="fas fa-chart-pie"></i></div>
                    <div class="function-info">
                        <h3>Statistika</h3>
                        <p>Batafsil tahlillar</p>
                    </div>
                </div>

                <div class="function-card" data-func="certificates">
                    <div class="function-icon"><i class="fas fa-certificate"></i></div>
                    <div class="function-info">
                        <h3>Sertifikatlar</h3>
                        <p>Yutuqlaringiz uchun sertifikatlar</p>
                    </div>
                </div>

                <div class="function-card" data-func="quick-quiz">
                    <div class="function-icon"><i class="fas fa-bolt"></i></div>
                    <div class="function-info">
                        <h3>Tezkor AI Quiz</h3>
                        <p>1 daqiqada 5 ta savol</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: Profile -->
        <section id="sectionProfile" class="section">
            <div class="profile-header">
                <div class="profile-avatar" id="profileAvatar">N</div>
                <div class="profile-info">
                    <h2 id="profileName">Foydalanuvchi</h2>
                    <p id="profileUsername">@username</p>
                    <div class="profile-id">ID: <span id="profileId">0</span></div>
                </div>
            </div>

            <div class="profile-stats-grid">
                <div class="profile-stat-card">
                    <div class="stat-icon"><i class="fas fa-bolt"></i></div>
                    <div class="stat-value" id="profileXP">0</div>
                    <div class="stat-label">XP</div>
                </div>
                <div class="profile-stat-card">
                    <div class="stat-icon"><i class="fas fa-coins"></i></div>
                    <div class="stat-value" id="profileGold">0</div>
                    <div class="stat-label">Gold</div>
                </div>
                <div class="profile-stat-card">
                    <div class="stat-icon"><i class="fas fa-layer-group"></i></div>
                    <div class="stat-value" id="profileLevel">1</div>
                    <div class="stat-label">Daraja</div>
                </div>
                <div class="profile-stat-card">
                    <div class="stat-icon"><i class="fas fa-fire"></i></div>
                    <div class="stat-value" id="profileStreak">0</div>
                    <div class="stat-label">Streak</div>
                </div>
            </div>

            <div class="section-title"><i class="fas fa-chart-bar"></i>Dashboard</div>
            <div class="dashboard-stats" id="dashboardStats"></div>

            <div class="section-title"><i class="fas fa-lightbulb"></i>AI tavsiyalari</div>
            <div class="recommendations-list" id="recommendationsList"></div>

            <div class="profile-actions">
                <button class="profile-action-btn" data-modal="help"><i class="fas fa-question-circle"></i>Yordam</button>
                <button class="profile-action-btn" data-modal="support"><i class="fas fa-headset"></i>Qo'llab-quvvatlash</button>
            </div>
        </section>

        <!-- Section: Premium -->
        <section id="sectionPremium" class="section">
            <div class="premium-header">
                <div class="premium-crown"><i class="fas fa-crown"></i></div>
                <h2>Premium obuna</h2>
                <p>Barcha imkoniyatlarni oching</p>
            </div>

            <div class="premium-status-card" id="premiumStatusCard">
                <div class="status-icon"><i class="fas fa-gem"></i></div>
                <div class="status-info">
                    <div class="status-text" id="premiumStatusText">Standard</div>
                    <div class="status-expiry" id="premiumExpiry"></div>
                </div>
            </div>

            <div class="premium-features">
                <div class="feature-item"><i class="fas fa-check"></i>Cheksiz AI so'rovlar</div>
                <div class="feature-item"><i class="fas fa-check"></i>2x XP va Gold</div>
                <div class="feature-item"><i class="fas fa-check"></i>Maxsus temalar</div>
                <div class="feature-item"><i class="fas fa-check"></i>Tezkor javoblar</div>
                <div class="feature-item"><i class="fas fa-check"></i>Kengaytirilgan statistika</div>
                <div class="feature-item"><i class="fas fa-check"></i>Eksklyuziv bonuslar</div>
            </div>

            <div class="premium-plans">
                <div class="plan-card" data-plan="weekly">
                    <div class="plan-duration">1 hafta</div>
                    <div class="plan-price">15,000 so'm</div>
                    <button class="plan-btn" data-plan="weekly" data-days="7" data-amount="15000">Sotib olish</button>
                </div>
                <div class="plan-card popular" data-plan="monthly">
                    <div class="plan-badge">Mashhur</div>
                    <div class="plan-duration">1 oy</div>
                    <div class="plan-price">49,000 so'm</div>
                    <button class="plan-btn" data-plan="monthly" data-days="30" data-amount="49000">Sotib olish</button>
                </div>
                <div class="plan-card" data-plan="yearly">
                    <div class="plan-duration">1 yil</div>
                    <div class="plan-price">399,000 so'm</div>
                    <div class="plan-save">40% tejash</div>
                    <button class="plan-btn" data-plan="yearly" data-days="365" data-amount="399000">Sotib olish</button>
                </div>
            </div>

            <div class="xp-exchange">
                <div class="exchange-info">
                    <i class="fas fa-exchange-alt"></i>
                    <div>
                        <h4>XP almashtirish</h4>
                        <p>10,000 XP = 1 kun Premium</p>
                    </div>
                </div>
                <div class="exchange-current">Sizda: <span id="exchangeXP">0</span> XP</div>
                <div class="exchange-actions">
                    <button class="exchange-btn" id="exchangeBtn" disabled>XP ➜ Premium</button>
                    <button class="exchange-btn secondary" id="goldExchangeBtn" disabled>Gold ➜ Premium</button>
                </div>
            </div>

            <div class="premium-utilities">
                <div class="section-title"><i class="fas fa-rocket"></i>Premium utilitalar</div>
                <div class="premium-utilities-grid">
                    <button class="premium-utility-card" data-modal="leaderboard">
                        <i class="fas fa-medal"></i>
                        <div>
                            <h4>Reytinglar</h4>
                            <p>Premium foydalanuvchilar uchun haftalik jadval</p>
                        </div>
                    </button>
                    <button class="premium-utility-card" data-modal="shop">
                        <i class="fas fa-store"></i>
                        <div>
                            <h4>Premium do'kon</h4>
                            <p>Eksklyuziv booster va skinlar</p>
                        </div>
                    </button>
                    <button class="premium-utility-card" data-modal="notifications">
                        <i class="fas fa-bell"></i>
                        <div>
                            <h4>Instant xabarnomalar</h4>
                            <p>Chegirma va voqealar haqida darhol xabar</p>
                        </div>
                    </button>
                </div>
            </div>
        </section>

        <!-- Section: AI Quiz -->
        <section id="sectionAiQuiz" class="section">
            <div class="quiz-container">
                <div class="quiz-header">
                    <h2><i class="fas fa-brain"></i>AI Quiz</h2>
                    <p>Bilimingizni sinab ko'ring</p>
                </div>

                <div class="quiz-stats-grid" id="quizStatsGrid"></div>

                <div class="quiz-categories">
                    <div class="section-title"><i class="fas fa-th-large"></i>Kategoriya</div>
                    <div class="categories-grid">
                        <div class="category-card active" data-category="general"><i class="fas fa-globe"></i><span>Umumiy</span></div>
                        <div class="category-card" data-category="science"><i class="fas fa-flask"></i><span>Fan</span></div>
                        <div class="category-card" data-category="history"><i class="fas fa-landmark"></i><span>Tarix</span></div>
                        <div class="category-card" data-category="tech"><i class="fas fa-microchip"></i><span>Texnologiya</span></div>
                        <div class="category-card" data-category="math"><i class="fas fa-calculator"></i><span>Matematika</span></div>
                        <div class="category-card" data-category="language"><i class="fas fa-language"></i><span>Tillar</span></div>
                    </div>
                </div>

                <div class="quiz-settings">
                    <div class="setting-group">
                        <label>Qiyinlik</label>
                        <div class="diff-buttons">
                            <button class="diff-btn" data-diff="easy">Oson</button>
                            <button class="diff-btn active" data-diff="medium">O'rta</button>
                            <button class="diff-btn" data-diff="hard">Qiyin</button>
                        </div>
                    </div>
                    <div class="setting-group">
                        <label>Savollar soni</label>
                        <div class="count-buttons">
                            <button class="count-btn" data-count="5">5</button>
                            <button class="count-btn active" data-count="10">10</button>
                            <button class="count-btn" data-count="20">20</button>
                        </div>
                    </div>
                </div>

                <button class="start-quiz-btn" id="startQuizBtn"><i class="fas fa-play"></i>Boshlash</button>
            </div>

            <!-- Quiz Game -->
            <div class="quiz-game" id="quizGame" style="display:none">
                <div class="quiz-game-header">
                    <button class="quiz-close-btn" id="quizCloseBtn"><i class="fas fa-times"></i></button>
                    <div class="quiz-progress" id="quizProgress">1/10</div>
                    <div class="quiz-timer" id="quizTimer"><i class="fas fa-clock"></i><span>30</span></div>
                </div>
                <div class="quiz-question" id="quizQuestion"></div>
                <div class="quiz-answers" id="quizAnswers"></div>
            </div>

            <!-- Quiz Results -->
            <div class="quiz-results" id="quizResults" style="display:none">
                <div class="results-icon"><i class="fas fa-trophy"></i></div>
                <h2>Quiz tugadi!</h2>
                <div class="results-score" id="resultsScore">0/0</div>
                <div class="results-accuracy" id="resultsAccuracy">0%</div>
                <div class="results-xp" id="resultsXP">+0 XP</div>
                <div class="results-actions">
                    <button class="results-btn retry" id="resultsRetryBtn"><i class="fas fa-redo"></i>Qayta</button>
                    <button class="results-btn back" id="resultsBackBtn"><i class="fas fa-home"></i>Orqaga</button>
                </div>
            </div>
        </section>

        <!-- Section: Admin -->
        <section id="sectionAdmin" class="section" style="display:none">
            <div class="admin-header">
                <h2><i class="fas fa-shield-alt"></i>Admin Panel</h2>
            </div>

            <div class="admin-stats">
                <div class="admin-stat-card">
                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                    <div class="stat-value" id="adminTotalUsers">0</div>
                    <div class="stat-label">Jami foydalanuvchilar</div>
                </div>
                <div class="admin-stat-card">
                    <div class="stat-icon"><i class="fas fa-user-check"></i></div>
                    <div class="stat-value" id="adminActiveUsers">0</div>
                    <div class="stat-label">Faol</div>
                </div>
                <div class="admin-stat-card">
                    <div class="stat-icon"><i class="fas fa-crown"></i></div>
                    <div class="stat-value" id="adminPremiumUsers">0</div>
                    <div class="stat-label">Premium</div>
                </div>
            </div>

            <div class="admin-section">
                <div class="section-title"><i class="fas fa-search"></i>Foydalanuvchi qidirish</div>
                <div class="admin-search">
                    <input type="text" id="adminSearchInput" placeholder="ID yoki username...">
                    <button id="adminSearchBtn"><i class="fas fa-search"></i></button>
                </div>
                <div class="admin-search-results" id="adminSearchResults"></div>
            </div>

            <div class="admin-section">
                <div class="section-title"><i class="fas fa-bullhorn"></i>Broadcast</div>
                <textarea id="broadcastText" placeholder="Xabar matni..."></textarea>
                <button class="admin-btn" id="broadcastBtn"><i class="fas fa-paper-plane"></i>Yuborish</button>
            </div>

            <div class="admin-section">
                <div class="section-title"><i class="fas fa-cogs"></i>Tizim</div>
                
                <div class="admin-setting-item" style="display:flex;justify-content:space-between;align-items:center;padding:12px;background:var(--bg-glass);border-radius:12px;margin-bottom:10px;border:1px solid var(--glass-border);">
                    <div style="font-size:13px;color:var(--text-primary);"><i class="fas fa-tools" style="color:var(--accent-gold);margin-right:8px;"></i>Texnik xizmat rejimi</div>
                    <label class="toggle"><input type="checkbox" id="maintenanceToggle"><span class="slider"></span></label>
                </div>

                <div class="admin-actions">
                    <button class="admin-action-btn" id="exportDataBtn"><i class="fas fa-download"></i>Ma'lumotlarni yuklash</button>
                    <button class="admin-action-btn danger" id="clearCacheBtn"><i class="fas fa-trash"></i>Keshni tozalash</button>
                </div>
            </div>
        </section>

        <!-- Floating Navigation -->
        <nav class="floating-nav">
            <div class="nav-item active" data-section="gamification"><i class="fas fa-gamepad"></i><span>O'yin</span></div>
            <div class="nav-item" data-section="newFunctions"><i class="fas fa-sparkles"></i><span>Yangi</span></div>
            <div class="nav-item" data-section="profile"><i class="fas fa-user"></i><span>Profil</span></div>
            <div class="nav-item" data-section="premium"><i class="fas fa-crown"></i><span>Premium</span></div>
            <div class="nav-item" data-section="aiQuiz"><i class="fas fa-brain"></i><span>Quiz</span></div>
            <div class="nav-item admin-nav" data-section="admin" style="display:none"><i class="fas fa-shield-alt"></i><span>Admin</span></div>
        </nav>
    </div>

    <!-- Modal Overlay -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle"><i class="fas fa-info-circle"></i><span>Modal</span></div>
                <button class="modal-close" id="modalClose"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <!-- Settings Overlay -->
    <div class="settings-overlay" id="settingsOverlay">
        <div class="settings-panel">
            <div class="settings-header">
                <h3><i class="fas fa-cog"></i>Sozlamalar</h3>
                <button class="settings-close" id="settingsClose"><i class="fas fa-times"></i></button>
            </div>
            <div class="settings-content">
                <div class="setting-item">
                    <div class="setting-info"><i class="fas fa-volume-up"></i><span>Ovoz</span></div>
                    <label class="toggle"><input type="checkbox" id="soundToggle" checked><span class="slider"></span></label>
                </div>
                <div class="setting-item">
                    <div class="setting-info"><i class="fas fa-mobile-alt"></i><span>Tebranish</span></div>
                    <label class="toggle"><input type="checkbox" id="hapticToggle" checked><span class="slider"></span></label>
                </div>
                <div class="setting-item">
                    <div class="setting-info"><i class="fas fa-palette"></i><span>Tema</span></div>
                    <select id="themeSelect"><option value="default">Standart</option><option value="dark">Qorong'i</option><option value="light">Yorug'</option></select>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Mystery Drop Container -->
    <div class="mystery-drop-container" id="mysteryDropContainer"></div>

    <!-- Visual Effects Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.8.0/vanilla-tilt.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/countup.js@2.0.7/dist/countUp.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <script src="nexus-ultimate.js"></script>
</body>
</html>
